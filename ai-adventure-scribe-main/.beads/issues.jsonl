{"id":"ai-adventure-scribe-main-nhd","title":"Phase 2: Hook damage application into roll completion","description":"Integrate damage-integrator into NPC roll completion flow. After auto-executed damage rolls complete, automatically apply damage to targets using applyDamageFromRoll(). Update npc-roll-handler.ts to call damage integrator when roll type is 'damage'. Persist damage to combat_damage_log table for history tracking.","status":"closed","issue_type":"feature","created_at":"2025-11-30T23:35:10.034720335Z","updated_at":"2025-11-30T23:37:31.062927794Z","closed_at":"2025-11-30T23:37:31.062927794Z"}
{"id":"ai-adventure-scribe-main-8l6","title":"Aggressively eliminate common LLM location name patterns","description":"Despite verbalized sampling, still generating Whisperwood, Blackfen, etc. Need to explicitly reject ALL common LLM patterns and force truly wild card selections (prob â‰¤0.25)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T01:45:48.112952397Z","updated_at":"2025-12-01T04:43:20.405307135Z","closed_at":"2025-12-01T04:43:20.405307135Z"}
{"id":"ai-adventure-scribe-main-10","title":"Fix dice rolls not being sent to DM - remove batch blocking logic in handleDiceRoll","status":"closed","issue_type":"task","created_at":"2025-11-18T22:45:41.629189-06:00","updated_at":"2025-11-18T22:46:27.507661-06:00","closed_at":"2025-11-18T22:46:27.507661-06:00"}
{"id":"ai-adventure-scribe-main-c3b","title":"Update useImageGeneration.ts to use semantic label generator","description":"Integrate new image-label-generator utility into useImageGeneration hook. Replace current label logic at line 79 with generateImageLabel(campaign?.name, sceneText). Fallback to 'scene' if campaign name unavailable. Ensure backward compatibility with existing images. File: /var/www/infiniterealms/ai-adventure-scribe-main/src/features/game-session/components/chat/message-list/useImageGeneration.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-02T05:43:38.777626764Z","updated_at":"2025-12-02T05:56:26.438447282Z","closed_at":"2025-12-02T05:56:26.438447282Z"}
{"id":"ai-adventure-scribe-main-dig","title":"Add verbalized sampling to opening message generator","description":"Opening messages need creative diversity for starting scenes - add verbalized sampling technique","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T00:08:18.430747072Z","updated_at":"2025-12-01T00:09:16.531699777Z","closed_at":"2025-12-01T00:09:16.531699777Z"}
{"id":"ai-adventure-scribe-main-zaw","title":"Add code documentation for session semantics in CampaignSessions.tsx","description":"Add clear code comments explaining Resume vs Continue semantics in the handleContinue function. Clarify that Resume navigates to existing session (no new session created) while Continue creates a new continuation session with incremented session_number. File: /var/www/infiniterealms/ai-adventure-scribe-main/src/pages/campaigns/CampaignSessions.tsx (Lines ~112-181)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-02T05:43:38.255182366Z","updated_at":"2025-12-02T05:45:09.721941325Z","closed_at":"2025-12-02T05:45:09.721941325Z"}
{"id":"ai-adventure-scribe-main-1gu","title":"Add advantage/disadvantage mechanics","description":"Document advantage/disadvantage in combat prompts - roll twice, take higher/lower","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T23:58:43.664074291Z","updated_at":"2025-12-01T00:00:02.686194571Z","closed_at":"2025-12-01T00:00:02.686194571Z"}
{"id":"ai-adventure-scribe-main-1","title":"TMP: verify json","status":"closed","priority":2,"issue_type":"task","created_at":"2025-10-14T18:53:05.29011-05:00","updated_at":"2025-11-30T08:39:41.074442007Z","closed_at":"2025-10-15T00:25:46.398138-05:00","dependencies":[{"issue_id":"ai-adventure-scribe-main-1","depends_on_id":"ai-adventure-scribe-main-2","type":"blocks","created_at":"2025-10-14T18:53:38.798658-05:00","created_by":"rob"}]}
{"id":"ai-adventure-scribe-main-21","title":"Add spell attack detection patterns","description":"Added 5 spell attack regex patterns (cast, use/fire/launch spell, ranged/melee spell attack) plus 13 common spell names (fire bolt, ray of frost, eldritch blast, sacred flame, magic missile, etc). Extracts spell name from player text and formats as attack purpose. Confidence: 0.93. File: src/utils/roll-request/parse.ts","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-11-09T22:02:25.788411-06:00","updated_at":"2025-11-10T22:26:20.294408-06:00","closed_at":"2025-11-09T22:02:38.967829-06:00","dependencies":[{"issue_id":"ai-adventure-scribe-main-21","depends_on_id":"ai-adventure-scribe-main-20","type":"blocks","created_at":"2025-11-09T22:02:38.679101-06:00","created_by":"rob"}]}
{"id":"ai-adventure-scribe-main-1de","title":"Remove old gemini-api-manager singleton files","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-01T05:19:47.730153616Z","updated_at":"2025-12-01T05:22:30.959921959Z","closed_at":"2025-12-01T05:22:30.959921959Z","dependencies":[{"issue_id":"ai-adventure-scribe-main-1de","depends_on_id":"ai-adventure-scribe-main-4p2","type":"blocks","created_at":"2025-12-01T05:20:00.45958833Z","created_by":"daemon"}]}
{"id":"ai-adventure-scribe-main-b36","title":"Phase 2: Add HP display to combat tracker UI","description":"Enhance combat tracker UI to display real-time HP status. Show current_hp/max_hp for all combat participants. Add visual indicators for low HP (below 50%, below 25%), unconscious state (0 HP), and temp HP overlay. Update UI whenever combat_participant_status changes. Location: combat tracker component or game session UI.","status":"closed","issue_type":"feature","created_at":"2025-11-30T23:35:16.272357486Z","updated_at":"2025-11-30T23:39:11.150333803Z","closed_at":"2025-11-30T23:39:11.150333803Z"}
{"id":"ai-adventure-scribe-main-16","title":"Fix combat options generation - dynamic options show generic exploration during combat","description":"The /dm/options endpoint generates generic exploration choices during combat instead of combat-specific actions because it doesn't interpret the COMBAT: ACTIVE state","status":"open","issue_type":"bug","created_at":"2025-11-08T01:10:37.466059-06:00","updated_at":"2025-11-10T22:26:20.293834-06:00"}
{"id":"ai-adventure-scribe-main-3aj","title":"Add action economy rules","description":"Document action, bonus action, reaction, and movement in combat","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T23:58:44.4096136Z","updated_at":"2025-12-01T00:00:03.324386414Z","closed_at":"2025-12-01T00:00:03.324386414Z"}
{"id":"ai-adventure-scribe-main-24","title":"Fix AI responding before dice roll - remove narrative before rolls","description":"Modify AI prompt to send ONLY roll requests with no narrative, and hide empty message bubbles in UI","status":"closed","issue_type":"task","created_at":"2025-11-10T01:12:55.680814-06:00","updated_at":"2025-11-10T22:26:20.294665-06:00","closed_at":"2025-11-10T01:17:37.079752-06:00"}
{"id":"ai-adventure-scribe-main-27","title":"Fix ESM/CommonJS compatibility issues","description":"Comprehensive fix for camelcase and other module import errors causing app crashes","status":"closed","issue_type":"task","created_at":"2025-11-17T22:53:56.649025-06:00","updated_at":"2025-11-17T22:56:28.899927-06:00","closed_at":"2025-11-17T22:56:28.899927-06:00"}
{"id":"ai-adventure-scribe-main-34","title":"Phase 1 Bonus: Add Settings Toggle for NPC Roll Display","description":"Enhanced CampaignSettings.tsx with 'Show NPC Rolls' toggle switch. Features: Eye/EyeOff icons, explanatory text about tabletop vs digital trade-offs, info box with tabletop note, status indicator when enabled. Uses localStorage key 'game:showNPCRolls' (default: true). Completely redesigned settings page from placeholder to functional UI. File: src/pages/campaigns/CampaignSettings.tsx","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-11-29T08:45:00-06:00","updated_at":"2025-11-29T09:00:00-06:00","closed_at":"2025-11-29T09:00:00-06:00","dependencies":[{"issue_id":"ai-adventure-scribe-main-34","depends_on_id":"ai-adventure-scribe-main-33","type":"blocks","created_at":"2025-11-29T08:50:00-06:00","created_by":"claude"}]}
{"id":"ai-adventure-scribe-main-5","title":"Feature: Map campaign genre backgrounds","description":"Updated GenreSelection to use new Traditional/Dark/High Fantasy background images.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-11-10T21:26:17.540707-06:00","updated_at":"2025-11-30T08:39:41.078881677Z","closed_at":"2025-10-15T00:28:01.163338-05:00"}
{"id":"ai-adventure-scribe-main-6","title":"Chore: Remove duplicate lizardfolk card image","description":"Removed /public/lizardfolkclass-card-background.png; kept in-use lizardfolk-class-card-background.png.","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-11-10T21:26:17.603234-06:00","updated_at":"2025-11-30T08:39:41.079873307Z","closed_at":"2025-10-15T00:28:01.232865-05:00"}
{"id":"ai-adventure-scribe-main-2rb","title":"Build, test, and verify campaign wizard fix","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T05:19:48.173607628Z","updated_at":"2025-12-01T05:26:38.632729065Z","closed_at":"2025-12-01T05:26:38.632729065Z","dependencies":[{"issue_id":"ai-adventure-scribe-main-2rb","depends_on_id":"ai-adventure-scribe-main-4p2","type":"blocks","created_at":"2025-12-01T05:20:00.684193757Z","created_by":"daemon"},{"issue_id":"ai-adventure-scribe-main-2rb","depends_on_id":"ai-adventure-scribe-main-1de","type":"blocks","created_at":"2025-12-01T05:20:00.950183324Z","created_by":"daemon"},{"issue_id":"ai-adventure-scribe-main-2rb","depends_on_id":"ai-adventure-scribe-main-1fn","type":"blocks","created_at":"2025-12-01T05:20:01.193168142Z","created_by":"daemon"}]}
{"id":"ai-adventure-scribe-main-19","title":"Add ROLL_REQUESTS_V1 structured prompt format","description":"Added 90-line prompt section (lines 632-721) instructing AI to output structured JSON in markdown code blocks for dice roll requests. Includes format spec, field requirements, 3 detailed examples (skill check, combat, saving throw), and important notes about code block placement. File: src/services/ai-service.ts","status":"closed","issue_type":"bug","created_at":"2025-11-09T22:02:12.740546-06:00","updated_at":"2025-11-10T22:26:20.294115-06:00","closed_at":"2025-11-09T22:02:38.821283-06:00","dependencies":[{"issue_id":"ai-adventure-scribe-main-19","depends_on_id":"ai-adventure-scribe-main-18","type":"blocks","created_at":"2025-11-09T22:02:38.49835-06:00","created_by":"rob"}]}
{"id":"ai-adventure-scribe-main-0wv","title":"Phase 4: Add healing integration","description":"Support healing spells and potions. Create healing roll type in ROLL_REQUESTS_V1. Apply healing via applyHealingFromRoll() from damage-integrator. Healing restores HP (capped at max), brings unconscious characters back (resets death saves), and wakes them up. Example: Cure Wounds (1d8+modifier), Potion of Healing (2d4+2).","status":"closed","issue_type":"feature","created_at":"2025-11-30T23:50:17.112145115Z","updated_at":"2025-11-30T23:52:31.183180617Z","closed_at":"2025-11-30T23:52:31.183180617Z"}
{"id":"ai-adventure-scribe-main-ds0","title":"Enhance campaign description with location/NPC name diversity","description":"Current verbalized sampling focuses on hooks but not proper nouns - add brainstorming for location names, NPC names, artifacts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T00:08:18.632890273Z","updated_at":"2025-12-01T00:09:16.74008652Z","closed_at":"2025-12-01T00:09:16.74008652Z"}
{"id":"ai-adventure-scribe-main-lpo","title":"Phase 4: Implement temp HP mechanics","description":"Add temporary hit points support. Temp HP is absorbed before real HP damage. Doesn't stack (use higher value). Healing doesn't restore temp HP. Add UI indicator for temp HP (already in CompactCharacterHeader as blue +X). AI should grant temp HP from spells like Heroism, Armor of Agathys, or class features.","status":"closed","issue_type":"feature","created_at":"2025-11-30T23:50:17.342935033Z","updated_at":"2025-11-30T23:53:11.487467017Z","closed_at":"2025-11-30T23:53:11.487467017Z"}
{"id":"ai-adventure-scribe-main-xr3","title":"Create image-label-generator.ts utility for semantic image labels","description":"Create new utility file /var/www/infiniterealms/ai-adventure-scribe-main/src/utils/image-label-generator.ts with function generateImageLabel(campaignName: string, sceneText: string). Logic: Sanitize campaign name (max 20 chars), extract 3-4 keywords from scene description (skip common words), combine as {campaignName}-{keyword1}-{keyword2}. Example: 'Dragons Lair tavern innkeeper' instead of 'scene-uuid'. Handle edge cases: long names, special chars, empty inputs.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-02T05:43:38.495111546Z","updated_at":"2025-12-02T05:55:55.162371384Z","closed_at":"2025-12-02T05:55:55.162371384Z"}
{"id":"ai-adventure-scribe-main-2","title":"Backfill: Baseline image inventory for /public","description":"Inventoried current images under public; counts by type and file list to enable diff after addition.","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-10-14T18:53:14.790527-05:00","updated_at":"2025-11-30T08:39:41.075976246Z","closed_at":"2025-10-15T00:28:01.052704-05:00"}
{"id":"ai-adventure-scribe-main-zde","title":"Phase 3: Fix turn order - prevent multiple player turns","description":"Issue: After player attacks, AI provides 3 options instead of narrating enemy's turn, causing player to get multiple turns in a row. Fix: Update AI prompts to automatically narrate NPC turns after player actions complete. Add turn flow logic that ensures turns alternate between player and NPCs in initiative order. Check combat context to determine whose turn it is.","status":"closed","issue_type":"bug","created_at":"2025-11-30T23:45:41.549746842Z","updated_at":"2025-11-30T23:47:22.907708636Z","closed_at":"2025-11-30T23:47:22.907708636Z"}
{"id":"ai-adventure-scribe-main-pby","title":"Fix opening message text duplication in game sessions","description":"Opening messages display with repeated paragraphs. Same text appears multiple times within a single message. Need to identify if duplication occurs during AI generation, storage, or retrieval.","status":"closed","issue_type":"task","created_at":"2025-12-02T04:48:25.634699387Z","updated_at":"2025-12-02T04:57:30.000732021Z","closed_at":"2025-12-02T04:57:30.000732021Z"}
{"id":"ai-adventure-scribe-main-4p2","title":"Fix getGeminiApiManager import error - update 6 files to use @/infrastructure/ai","status":"closed","issue_type":"task","created_at":"2025-12-01T05:19:47.490826591Z","updated_at":"2025-12-01T05:21:06.361094531Z","closed_at":"2025-12-01T05:21:06.361094531Z"}
{"id":"ai-adventure-scribe-main-29","title":"Set up semantic versioning (commitlint, husky, standard-version)","status":"closed","issue_type":"task","created_at":"2025-11-28T22:21:32.552376-06:00","updated_at":"2025-11-28T22:30:05.438695-06:00","closed_at":"2025-11-28T22:30:05.438695-06:00"}
{"id":"ai-adventure-scribe-main-37","title":"Phase 1: Create NPC Auto-Roller Service","description":"Created npc-auto-roller.ts - core auto-roll service for NPCs. Functions: executeNPCRoll() for single rolls, executeAllNPCRolls() to separate and execute all NPC rolls from batch, formatNPCRollResult() for chat display, helper functions isAttackHit() and isCheckSuccess(). Integrates with existing DiceEngine service. File: src/services/combat/npc-auto-roller.ts (188 lines)","status":"closed","issue_type":"feature","created_at":"2025-11-29T06:15:00-06:00","updated_at":"2025-11-29T06:45:00-06:00","closed_at":"2025-11-29T06:45:00-06:00","dependencies":[{"issue_id":"ai-adventure-scribe-main-37","depends_on_id":"ai-adventure-scribe-main-36","type":"blocks","created_at":"2025-11-29T06:20:00-06:00","created_by":"claude"}]}
{"id":"ai-adventure-scribe-main-0m2","title":"E2E testing for session management and image gallery","description":"Test complete flow: 1) Create new campaign 2) Start new session - verify button shows correctly 3) Complete session - verify Continue creates new session 4) Resume active session - verify navigation without new session creation 5) Generate scene image - verify semantic label 6) Check campaign gallery - verify readable names 7) Navigate all campaign tabs - verify no errors. Test on both mobile and desktop viewports.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-02T05:43:39.104555057Z","updated_at":"2025-12-02T05:43:39.104555057Z"}
{"id":"ai-adventure-scribe-main-8","title":"UX: Improve text contrast on image-backed cards","description":"Strengthened overlays and badge styles on genre, race, and sub-race cards for readability.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-11-10T22:25:32.62501-06:00","updated_at":"2025-11-30T08:39:41.081954342Z","closed_at":"2025-10-15T00:29:55.757326-05:00"}
{"id":"ai-adventure-scribe-main-ano","title":"Phase 3: Auto-trigger NPC turns after player","description":"When turn advances to NPC/enemy participant, automatically execute their turn without waiting for player input. AI should: 1) Check whose turn it is, 2) If NPC turn, narrate their action and execute rolls with autoExecute, 3) Apply damage/effects, 4) Advance to next turn. NO player prompts during NPC turns.","status":"closed","issue_type":"feature","created_at":"2025-11-30T23:45:51.979764634Z","updated_at":"2025-11-30T23:47:42.567748207Z","closed_at":"2025-11-30T23:47:42.567748207Z"}
{"id":"ai-adventure-scribe-main-22","title":"Fix AI DM extra response before dice roll completes","status":"closed","issue_type":"task","created_at":"2025-11-09T23:18:27.112831-06:00","updated_at":"2025-11-10T22:26:20.294504-06:00","closed_at":"2025-11-09T23:18:31.721784-06:00"}
{"id":"ai-adventure-scribe-main-4","title":"Feature: Integrate subrace card backgrounds and rendering","description":"Added backgroundImage to Subrace; set for dwarf/elf/gnome/halfling/human/elementalborn; rendered in RaceSelection UI.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-11-10T21:26:17.477127-06:00","updated_at":"2025-11-30T08:39:41.077936413Z","closed_at":"2025-10-15T00:28:01.128655-05:00"}
{"id":"ai-adventure-scribe-main-ax4","title":"Add critical hit rules","description":"Document critical hit mechanics - nat 20 doubles damage dice","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T23:58:43.90640466Z","updated_at":"2025-12-01T00:00:02.908586972Z","closed_at":"2025-12-01T00:00:02.908586972Z"}
{"id":"ai-adventure-scribe-main-17","title":"AI not requesting dice rolls - narrates outcomes directly","description":"Investigation shows AI (Gemini) ignores existing dice roll instructions in prompts (both prompts.ts and promptBuilder.ts have XML-tagged roll request sections). AI narrates action outcomes directly instead of requesting player rolls. Roll parsing system exists and works (parseRollRequests), but returns 0 requests because AI text doesn't contain trigger phrases like 'make a Perception check' or 'roll initiative'. Evidence: Logs show 'ðŸŽ² Parsed roll requests from DM text: 0' on every response. Root cause: Gemini defaults to narrative mode despite \u003cdice_rolling\u003e\u003ctitle\u003eCRITICAL: ALWAYS REQUEST DICE ROLLS\u003c/title\u003e instructions being present in XML prompts.","notes":"Root Cause: 1) Parser regression (9d7724b) stripped content before regex - FIXED in aa499ea. 2) Prompts changed to XML tags (da10179) - FIXED by adding bold headers. Both issues resolved. Ready for testing.","status":"closed","issue_type":"bug","created_at":"2025-11-08T09:27:51.417508-06:00","updated_at":"2025-11-10T22:26:20.293928-06:00","closed_at":"2025-11-08T09:44:16.150085-06:00"}
{"id":"ai-adventure-scribe-main-9pn","title":"Remove duplicate BasicDetails.tsx files","description":"Delete 2 unused copies of BasicDetails from legacy directory structures","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T04:39:34.113757179Z","updated_at":"2025-12-01T04:41:32.185063693Z","closed_at":"2025-12-01T04:41:32.185063693Z"}
{"id":"ai-adventure-scribe-main-14","title":"Investigate: turnCount access during AI response","description":"Find where session turnCount is accessible during AI response generation for memory degradation logic","status":"closed","issue_type":"chore","created_at":"2025-11-08T00:22:37.141572-06:00","updated_at":"2025-11-10T22:26:20.29364-06:00","closed_at":"2025-11-08T00:25:16.01143-06:00"}
{"id":"ai-adventure-scribe-main-20","title":"Update parser to extract ROLL_REQUESTS_V1 code blocks","description":"Enhanced parser with PRIORITY 1 code block extraction (confidence 1.0) before falling back to regex patterns. Parses ROLL_REQUESTS_V1 blocks, extracts JSON, converts to ParsedRollRequest objects. If structured data found, returns immediately without regex fallback. File: src/utils/roll-request/parse.ts","status":"closed","issue_type":"bug","created_at":"2025-11-09T22:02:25.722286-06:00","updated_at":"2025-11-10T22:26:20.294321-06:00","closed_at":"2025-11-09T22:02:38.896156-06:00","dependencies":[{"issue_id":"ai-adventure-scribe-main-20","depends_on_id":"ai-adventure-scribe-main-19","type":"blocks","created_at":"2025-11-09T22:02:38.606793-06:00","created_by":"rob"}]}
{"id":"ai-adventure-scribe-main-cpk","title":"Add encounter difficulty scaling guidelines (CR balancing)","description":"Added comprehensive encounter_difficulty section to AI prompts with CR scaling by character level. Level 1-2: CR 1/8 to 1/2 (max 6 damage), Level 3-4: CR 1/2 to 2 (max 10 damage), etc. Prevents TPK by ensuring enemies don't deal \u003e50% max HP in one hit. Includes specific examples (Goblin, Wolf, Orc) and damage guidelines. Location: src/services/ai-service.ts lines 1098-1133","status":"closed","issue_type":"feature","created_at":"2025-11-30T23:40:22.199842587Z","updated_at":"2025-11-30T23:40:36.182361488Z","closed_at":"2025-11-30T23:40:36.182361488Z"}
{"id":"ai-adventure-scribe-main-9","title":"Add 2-second delay to dice roll result display","description":"Modify DiceRollRequest components to show dice roll results for 2 seconds before submitting to chat","status":"closed","issue_type":"task","created_at":"2025-11-10T23:48:42.789783-06:00","updated_at":"2025-11-11T00:37:11.99379-06:00","closed_at":"2025-11-11T00:37:11.99379-06:00"}
{"id":"ai-adventure-scribe-main-1fn","title":"Remove duplicate campaign creation directories","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-01T05:19:47.951960371Z","updated_at":"2025-12-01T05:23:02.83600471Z","closed_at":"2025-12-01T05:23:02.83600471Z"}
{"id":"ai-adventure-scribe-main-a96","title":"Update SessionCard.tsx with Resume/Continue button logic","description":"Modify button label and styling based on session status. Active sessions (status='active', not expired) show 'Resume Session' with primary styling. Completed/expired sessions show 'Continue Session' with outline styling. Add helper text below buttons: 'Resume where you left off' vs 'Create continuation session'. File: /var/www/infiniterealms/ai-adventure-scribe-main/src/pages/campaigns/SessionCard.tsx (Lines ~115-148)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-02T05:43:38.001322913Z","updated_at":"2025-12-02T05:44:41.614400563Z","closed_at":"2025-12-02T05:44:41.614400563Z"}
{"id":"ai-adventure-scribe-main-26","title":"Implement batched dice rolls with enhanced formatting","description":"Batch multiple dice rolls from same AI request into one message with enhanced formatting. Include roll type, natural roll, modifiers, DC/AC, success indicators, and critical detection. Optimized for both human readability and AI comprehension.","status":"closed","issue_type":"task","created_at":"2025-11-10T22:50:56.584476-06:00","updated_at":"2025-11-10T22:56:28.965272-06:00","closed_at":"2025-11-10T22:56:28.965272-06:00"}
{"id":"ai-adventure-scribe-main-31","title":"Create GitHub Actions release workflow","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T22:21:39.32895-06:00","updated_at":"2025-11-28T22:40:35.342222-06:00","closed_at":"2025-11-28T22:40:35.342222-06:00"}
{"id":"ai-adventure-scribe-main-33","title":"Phase 1 Bonus: Create NPC Roll Display Popup Component","description":"Created NPCRollDisplay.tsx - Dramatic 'Behind the DM Screen' popup component with dark fantasy aesthetic. Features: aged parchment background with texture overlay, dice roll animation (800ms), status-based gradient colors (critical/hit/miss/fumble), magical particle effects, Cinzel Decorative and Merriweather fonts, auto-dismiss after 3 seconds, queue system via useNPCRollQueue hook. File: src/components/game/NPCRollDisplay.tsx (386 lines)","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-11-29T08:30:00-06:00","updated_at":"2025-11-29T08:45:00-06:00","closed_at":"2025-11-29T08:45:00-06:00"}
{"id":"ai-adventure-scribe-main-32","title":"Configure Vercel for blog.infiniterealms.app subdomain","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T22:21:41.339858-06:00","updated_at":"2025-11-28T22:40:39.897156-06:00","closed_at":"2025-11-28T22:40:39.897156-06:00"}
{"id":"ai-adventure-scribe-main-7","title":"Tech: Extend types for backgroundImage fields","description":"Extended types in src/types/character.ts for CharacterClass and Subrace backgroundImage fields.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-10T22:02:37.612707-06:00","updated_at":"2025-11-30T08:39:41.081016151Z","closed_at":"2025-10-15T00:29:55.723229-05:00"}
{"id":"ai-adventure-scribe-main-12","title":"Add visible quota display UI component","description":"Display 'ðŸŽ² Your Daily Adventure Credits: X/30 remaining' in game session UI. Show upgrade CTA when quota \u003c 5. Fetch from quota endpoint.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-11-08T00:22:30.071985-06:00","updated_at":"2025-11-10T22:26:20.293395-06:00","closed_at":"2025-11-08T00:36:22.856087-06:00","dependencies":[{"issue_id":"ai-adventure-scribe-main-12","depends_on_id":"ai-adventure-scribe-main-15","type":"blocks","created_at":"2025-11-08T00:22:45.292582-06:00","created_by":"rob"}]}
{"id":"ai-adventure-scribe-main-40","title":"Fix conflicting combat prompts causing AI to roll for players","description":"Fixed two conflicting prompt sections in ai-service.ts that were telling AI to 'Generate dice rolls' and 'Include actual dice roll results' instead of requesting rolls via ROLL_REQUESTS_V1. Updated formatCombatContext() (lines 631-644) to emphasize REQUEST rolls for player actions and AUTO-EXECUTE for NPC actions. Updated combat_roll_requirements section (lines 1273-1288) to clarify DO NOT roll for player, must use ROLL_REQUESTS_V1, and STOP after block. This was causing AI to narrate roll results directly instead of requesting player rolls. File: src/services/ai-service.ts","status":"closed","issue_type":"bug","created_at":"2025-11-30T00:20:00-06:00","updated_at":"2025-11-30T00:30:00-06:00","closed_at":"2025-11-30T00:30:00-06:00"}
{"id":"ai-adventure-scribe-main-13","title":"Investigate: User plan access pattern in ai-service.ts","description":"Find how to access user's plan (free/pro/enterprise) in ai-service.ts context for memory degradation logic","status":"closed","issue_type":"chore","created_at":"2025-11-08T00:22:37.08592-06:00","updated_at":"2025-11-10T22:26:20.293527-06:00","closed_at":"2025-11-08T00:24:40.704415-06:00"}
{"id":"ai-adventure-scribe-main-3","title":"Feature: Integrate class card backgrounds","description":"Added backgroundImage to CharacterClass; set class backgrounds; rendered on ClassSelection cards.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-11-09T23:09:04.486044-06:00","updated_at":"2025-11-30T08:39:41.076987102Z","closed_at":"2025-10-15T00:28:01.086784-05:00"}
{"id":"ai-adventure-scribe-main-30","title":"Create internal blog API for automated release posts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T22:21:36.647003-06:00","updated_at":"2025-11-28T22:40:25.376396-06:00","closed_at":"2025-11-28T22:40:25.376396-06:00"}
{"id":"ai-adventure-scribe-main-9zm","title":"Phase 3: Implement turn advancement logic","description":"Create turn manager that tracks initiative order and advances to next combatant. After player action completes (attack + damage resolved), automatically advance to next participant in initiative. Track current turn in combat_encounters.current_turn_participant_id. Integrate with combat_participants.turn_order for proper sequencing.","status":"closed","issue_type":"feature","created_at":"2025-11-30T23:45:51.700514591Z","updated_at":"2025-11-30T23:47:42.361221897Z","closed_at":"2025-11-30T23:47:42.361221897Z"}
{"id":"ai-adventure-scribe-main-28","title":"Fix decamelize module import error","description":"Add decamelize to package overrides and vite config","status":"closed","issue_type":"task","created_at":"2025-11-18T00:18:41.648772-06:00","updated_at":"2025-11-18T00:19:21.990477-06:00","closed_at":"2025-11-18T00:19:21.990477-06:00"}
{"id":"ai-adventure-scribe-main-zpr","title":"Switch BasicDetails.tsx to local campaign service","description":"Replace Edge Function call with AIService.generateCampaignDescription() to enable verbalized sampling","status":"closed","issue_type":"task","created_at":"2025-12-01T04:39:33.49046707Z","updated_at":"2025-12-01T04:40:26.557509292Z","closed_at":"2025-12-01T04:40:26.557509292Z"}
{"id":"ai-adventure-scribe-main-o7l","title":"Phase 4: Handle multiple enemies in combat","description":"Ensure AI can manage multiple enemies simultaneously. When player attacks, AI should specify which enemy (e.g., 'Goblin 1', 'Goblin 2'). Track enemy HP individually. Auto-execute all enemy turns in initiative order. Example: '2 goblins attack - Goblin 1 lunges at you (autoExecute roll), Goblin 2 flanks from the side (autoExecute roll)'.","status":"closed","issue_type":"feature","created_at":"2025-11-30T23:50:02.080511959Z","updated_at":"2025-11-30T23:51:01.825844136Z","closed_at":"2025-11-30T23:51:01.825844136Z"}
{"id":"ai-adventure-scribe-main-x3f","title":"Fix 402 Payment Required - reduce API calls from 5-10 to 1.3 per message","description":"Fixed quota exhaustion by: 1) Separate llm vs llm_system quotas, 2) XML-tagged DM responses for inline memory/world extraction, 3) Fallback batching. Result: 4 API calls for 3 messages vs previous 15-30.","status":"closed","issue_type":"bug","created_at":"2025-11-30T15:04:16.816161779Z","updated_at":"2025-11-30T15:05:20.616610695Z","closed_at":"2025-11-30T15:05:20.616610695Z"}
{"id":"ai-adventure-scribe-main-ghe","title":"Phase 2: Create combat damage integrator service","description":"Create damage-integrator.ts service that bridges roll results to HP tracking. Functions: applyDamageFromRoll() to calculate and apply damage with resistances/vulnerabilities, applyHealingFromRoll() for healing, updateParticipantHP() to persist to database via combat_participant_status table. Integrates with existing combat database schema (combat_participants, combat_participant_status, combat_damage_log).","status":"closed","issue_type":"feature","created_at":"2025-11-30T23:35:03.497922928Z","updated_at":"2025-11-30T23:36:25.796304227Z","closed_at":"2025-11-30T23:36:25.796304227Z"}
{"id":"ai-adventure-scribe-main-38","title":"Phase 1: Integrate Auto-Roller into DM Agent Flow","description":"Integrated NPC auto-roller into use-ai-response.ts. Added auto-execution logic (lines 468-512) that separates NPC rolls from player rolls using executeAllNPCRolls(), executes NPC rolls behind the screen, stores results in npcRollResults array, calls continueNarrativeWithNPCRolls() for AI continuation, appends continuation text to response. Only player rolls remain in UI prompts. File: src/hooks/use-ai-response.ts","status":"closed","issue_type":"feature","created_at":"2025-11-29T06:45:00-06:00","updated_at":"2025-11-29T07:30:00-06:00","closed_at":"2025-11-29T07:30:00-06:00","dependencies":[{"issue_id":"ai-adventure-scribe-main-38","depends_on_id":"ai-adventure-scribe-main-37","type":"blocks","created_at":"2025-11-29T06:50:00-06:00","created_by":"claude"}]}
{"id":"ai-adventure-scribe-main-8p4","title":"Remove generate-campaign-description Edge Function","description":"Delete supabase/functions/generate-campaign-description directory - no longer needed","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-01T04:39:33.782212708Z","updated_at":"2025-12-01T04:40:40.507846877Z","closed_at":"2025-12-01T04:40:40.507846877Z"}
{"id":"ai-adventure-scribe-main-8qo","title":"Add combat conditions","description":"Document status conditions - paralyzed, stunned, prone, restrained, etc.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T23:58:44.147333243Z","updated_at":"2025-12-01T00:00:03.11243293Z","closed_at":"2025-12-01T00:00:03.11243293Z"}
{"id":"ai-adventure-scribe-main-35","title":"Phase 1 Bonus: Integrate NPC Roll Popup into Game Chat","description":"Integrated NPCRollDisplay into SimpleGameChatWithVoice.tsx. Added imports for NPCRollDisplay and useNPCRollQueue, showNPCRolls state from localStorage, roll detection logic (lines 380-386) that checks response.context.npcRollResults, addRolls() call to queue system, conditional popup rendering (lines 580-582). Popup displays when showNPCRolls is enabled and npcRollResults are present in AI response. File: src/features/game-session/components/chat/SimpleGameChatWithVoice.tsx","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-11-29T09:00:00-06:00","updated_at":"2025-11-29T09:15:00-06:00","closed_at":"2025-11-29T09:15:00-06:00","dependencies":[{"issue_id":"ai-adventure-scribe-main-35","depends_on_id":"ai-adventure-scribe-main-33","type":"blocks","created_at":"2025-11-29T09:05:00-06:00","created_by":"claude"},{"issue_id":"ai-adventure-scribe-main-35","depends_on_id":"ai-adventure-scribe-main-34","type":"blocks","created_at":"2025-11-29T09:05:00-06:00","created_by":"claude"}]}
{"id":"ai-adventure-scribe-main-ci5","title":"Phase 4: Implement death saves at 0 HP","description":"When character reaches 0 HP, trigger death saving throw mechanic. Track successes (3 = stabilized) and failures (3 = dead). Each turn at 0 HP requires death save (DC 10). Natural 20 = regain 1 HP, Natural 1 = 2 failures. Update combat_participant_status.death_saves_successes and death_saves_failures. AI should prompt for death saves and explain the stakes.","status":"closed","issue_type":"feature","created_at":"2025-11-30T23:50:16.849153245Z","updated_at":"2025-11-30T23:51:52.320535849Z","closed_at":"2025-11-30T23:51:52.320535849Z"}
{"id":"ai-adventure-scribe-main-18","title":"Restore ROLL_KEYWORDS array and helper functions","description":"Restored ~214 lines from commit 9d7724b including ROLL_KEYWORDS array with 9 skill mappings (attack, stealth, persuasion, intimidation, investigation, acrobatics, athletics, perception, insight), plus helper functions: isPaymentRequiredError, determineFallbackRoll, formatRollInstruction, serializeRollForBlock, buildPaymentRequiredFallback. File: src/services/ai-service.ts","status":"closed","issue_type":"bug","created_at":"2025-11-09T22:02:12.672295-06:00","updated_at":"2025-11-10T22:26:20.294031-06:00","closed_at":"2025-11-09T22:02:38.750666-06:00"}
{"id":"ai-adventure-scribe-main-8zx","title":"Remove unused DescriptionGeneratorButton files","description":"Delete all 3 DescriptionGeneratorButton copies (none are imported)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T04:39:34.434280753Z","updated_at":"2025-12-01T04:41:32.217273487Z","closed_at":"2025-12-01T04:41:32.217273487Z"}
{"id":"ai-adventure-scribe-main-15","title":"Investigate: Quota endpoint status and UI location","description":"Check if GET /v1/llm/quota endpoint exists or needs creation. Identify where to place quota UI in game session page.","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-11-08T00:22:37.200871-06:00","updated_at":"2025-11-10T22:26:20.293746-06:00","closed_at":"2025-11-08T00:25:39.881565-06:00"}
{"id":"ai-adventure-scribe-main-36","title":"Phase 1: Add autoExecute flag to RollRequest schema","description":"Extended RollRequest interface in DiceRollRequest.tsx to support auto-execution. Added two new optional fields: autoExecute (boolean) to mark NPC rolls for auto-execution 'behind the screen', and actorName (string) for identifying who's rolling (e.g., 'Goblin Archer'). File: src/components/game/DiceRollRequest.tsx","status":"closed","issue_type":"feature","created_at":"2025-11-29T06:00:00-06:00","updated_at":"2025-11-29T06:15:00-06:00","closed_at":"2025-11-29T06:15:00-06:00","dependencies":[{"issue_id":"ai-adventure-scribe-main-36","depends_on_id":"ai-adventure-scribe-main-33","type":"blocks","created_at":"2025-11-30T12:00:00-06:00","created_by":"claude"}]}
{"id":"ai-adventure-scribe-main-23","title":"Fix AI narrating outcomes before requesting dice rolls","status":"closed","issue_type":"task","created_at":"2025-11-10T00:44:49.169566-06:00","updated_at":"2025-11-10T22:26:20.294585-06:00","closed_at":"2025-11-10T00:47:01.35453-06:00"}
{"id":"ai-adventure-scribe-main-25","title":"Fix code block removal in removeRollRequestsFromMessage","status":"closed","issue_type":"task","created_at":"2025-11-10T21:12:35.430716-06:00","updated_at":"2025-11-10T22:26:20.294761-06:00","closed_at":"2025-11-10T21:13:00.972188-06:00"}
{"id":"ai-adventure-scribe-main-11","title":"Fix dice rolls not being sent to DM - remove batch blocking logic in handleManualResult","status":"closed","issue_type":"task","created_at":"2025-11-18T22:45:46.990102-06:00","updated_at":"2025-11-18T22:47:08.047409-06:00","closed_at":"2025-11-18T22:47:08.047409-06:00","dependencies":[{"issue_id":"ai-adventure-scribe-main-11","depends_on_id":"ai-adventure-scribe-main-13","type":"blocks","created_at":"2025-11-08T00:22:45.161752-06:00","created_by":"rob"},{"issue_id":"ai-adventure-scribe-main-11","depends_on_id":"ai-adventure-scribe-main-14","type":"blocks","created_at":"2025-11-08T00:22:45.230345-06:00","created_by":"rob"}]}
{"id":"ai-adventure-scribe-main-39","title":"Phase 1: Add AI Continuation Handler for NPC Rolls","description":"Created npc-roll-handler.ts to send NPC roll results back to AI DM for narrative continuation. Functions: continueNarrativeWithNPCRolls() formats roll results and calls AIService.chatWithDM() with continuation prompt, formatNPCRollsSystemMessage() creates summary for chat display. Includes fallback narrative on error. File: src/services/ai/npc-roll-handler.ts (193 lines)","status":"closed","issue_type":"feature","created_at":"2025-11-29T07:30:00-06:00","updated_at":"2025-11-29T08:30:00-06:00","closed_at":"2025-11-29T08:30:00-06:00","dependencies":[{"issue_id":"ai-adventure-scribe-main-39","depends_on_id":"ai-adventure-scribe-main-38","type":"blocks","created_at":"2025-11-29T07:35:00-06:00","created_by":"claude"}]}
